nelmio_security:
    # Enforce HTTPS in production
    forced_ssl:
        enabled: false  # Set to true in production
        hsts_max_age: 31536000 # 1 year
        hsts_subdomains: true
        hsts_preload: true

    # Content Security Policy
    csp:
        enabled: true
        enforce:
            default-src: ["'self'"]
            script-src: ["'self'", "'unsafe-inline'", "https://cdn.jsdelivr.net", "https://cdnjs.cloudflare.com"]
            style-src: ["'self'", "'unsafe-inline'", "https://fonts.googleapis.com", "https://cdn.jsdelivr.net", "https://cdnjs.cloudflare.com"]
            img-src: ["'self'", "data:", "https:", "blob:"]
            font-src: ["'self'", "https://fonts.gstatic.com", "https://cdnjs.cloudflare.com"]
            connect-src: ["'self'"]
            frame-src: ["'none'"]
            object-src: ["'none'"]
            base-uri: ["'self'"]
            form-action: ["'self'"]
# report-uri: '/csp-report'  # Enable for CSP violation reporting

    # prevents framing of the entire site
    clickjacking:
        paths:
            '^/.*': DENY

    # disables content type sniffing for script resources
    content_type:
        nosniff: true

    # Send a full URL in the `Referer` header when performing a same-origin request,
    # only send the origin of the document to secure destination (HTTPS->HTTPS),
    # and send no header to a less secure destination (HTTPS->HTTP).
    # If `strict-origin-when-cross-origin` is not supported, use `no-referrer` policy,
    # no referrer information is sent along with requests.
    referrer_policy:
        enabled: true
        policies:
            - 'no-referrer'
            - 'strict-origin-when-cross-origin'

    # XSS Protection
    xss_protection:
        enabled: true
        mode_block: true

    # Prevent external redirects (open redirect protection)
    external_redirects:
        abort: true
        log: true
